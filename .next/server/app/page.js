(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},6990:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>p,tree:()=>c}),s(4148),s(3733),s(996);var l=s(170),a=s(5002),n=s(3876),i=s.n(n),d=s(6299),r={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(r[e]=()=>d[e]);s.d(t,r);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4148)),"/Users/ahmed.galal/back-office/back-office-next/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,3733)),"/Users/ahmed.galal/back-office/back-office-next/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],x=["/Users/ahmed.galal/back-office/back-office-next/src/app/page.tsx"],o="/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5100:(e,t,s)=>{Promise.resolve().then(s.bind(s,7620))},7620:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var l=s(7247),a=s(5253),n=s(2777),i=s(5438),d=s(9189),r=s(5),c=s(4178),x=s(8964),o=s(5459),m=s(1986),p=s(2868),u=s(9063);s(4129),s(4332);let h=({src:e,onSave:t})=>{let s=(0,x.useRef)(null);return(0,l.jsxs)("div",{className:"example flex flex-col items-center gap-3",children:[l.jsx("div",{className:"example__cropper-wrapper",children:l.jsx(u.U8w,{ref:s,src:e,stencilSize:{width:650,height:290},stencilProps:{handlers:!1,lines:!1,movable:!1,resizable:!1},style:{width:window.innerWidth>768?"400px":"300px",height:window.innerWidth>768?"400px":"300px"},imageRestriction:u.iyG.stencil})}),l.jsx("button",{className:"bg-THEME_PRIMARY_COLOR rounded-lg h-10 w-[181px] text-center text-white",onClick:()=>{let e=s.current;e&&t(e.getCanvas().toDataURL("image/jpeg",.7))},children:"تحميل"})]})};function f({imageSrc:e,onSave:t,onCancel:s}){let[a,n]=(0,x.useState)(e);return l.jsx("div",{className:"z-[1000]",children:l.jsx("div",{className:"fixed top-0 pt-0 md:pt-8  left-0 min-w-full  overflow-hidden flex justify-center  items-center min-h-[100vh] bg-[#00000073]  z-[300] px-3 md:px-[150px] ",children:(0,l.jsxs)("div",{className:" rounded-lg bg-white w-[320px] md:w-[550px] h-[450px] md:h-[550px] flex flex-col gap-3 justify-between p-6 items-center",children:[l.jsx("div",{className:"w-full flex px-3 justify-start items-start",children:l.jsx("img",{src:"/assets/closeBlack.png",onClick:s,width:28,height:28})}),l.jsx(h,{onSave:t,src:a})]})})})}let g=({form:e,setForm:t})=>{let[s,a]=(0,x.useState)(),[n,i]=(0,x.useState)(),[d,r]=(0,x.useState)(!1),[c,o]=(0,x.useState)(!0),[m,u]=(0,x.useState)(""),{getInputProps:h}=(0,p.uI)({accept:{"image/jpeg":[".jpeg"],"image/jpg":[".jpg"],"image/png":[".png"]},onDrop:e=>{i(e?.[0]?.type),u(e?.[0]?.name),e.map(e=>Object.assign(e,{preview:URL.createObjectURL(e)})),r(!0),document.getElementById("body").style.overflow="hidden",a(e),o(!1)},disabled:!c});return l.jsx(l.Fragment,{children:s?.[0]?.preview?l.jsx(l.Fragment,{children:d?l.jsx(f,{imageSrc:s?.[0]?.preview,onCancel:()=>{a(null),document.getElementById("body").style.overflow="scroll",r(!1),o(!0)},onSave:s=>{let l=function(e,t,s){let l=new File([function(e,t="",s=512){let l=atob(e),a=[];for(let e=0;e<l.length;e+=s){let t=l.slice(e,e+s),n=Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);let i=new Uint8Array(n);a.push(i)}return new Blob(a,{type:t})}(e,s)],t,{type:s,lastModified:new Date().getTime()});return l.preview=URL.createObjectURL(l),l}(s?.split(",")?.[1],`check.${n?.split("/")[1]}`,n);t({...e,image:l}),a(null),document.getElementById("body").style.overflow="scroll",r(!1),o(!0)}}):null}):(0,l.jsxs)("label",{className:"file-upload",children:[l.jsx("input",{type:"file",...h()}),l.jsx("span",{children:e?.image?m:"تحميل صورة الشيك"}),l.jsx("img",{src:"/assets/uploadImage.svg",width:30,alt:"Upload Icon"})]})})};function b({isModal:e,setShowModal:t}){(0,r.getCookie)("authToken"),(0,c.useRouter)();let{currentUser:s,setCurrentUser:p}=(0,n.b)(),[u,h]=(0,x.useState)(!1),[f,b]=(0,x.useState)(""),[j,w]=(0,x.useState)(""),[N,v]=(0,x.useState)(!1),y=(0,x.useMemo)(()=>{let e=[...new Set([...s?.bankChecks.map(e=>e.unitId)??[],...s?.payments.map(e=>e.unitId)??[]])];return[...e=(e=e.filter(e=>""!=e)?.sort((e,t)=>e?.split("/")[1]-t?.split("/")[1])).map(e=>({value:e,label:e}))]},[s]),[C,E]=(0,x.useState)({id:void 0,unitId:void 0,number:void 0,dueDate:new Date()?.toISOString()?.split("T")?.[0],amount:void 0,bankName:void 0,image:void 0}),I=()=>{b(""),h(!0);let l=new FormData;l.set("id",s?.info.id),l.set("unitId","حجز جديد"==C.unitId?"":C.unitId),l.set("number",C.number),l.set("dueDate",C.dueDate),l.set("amount",C.amount),l.set("bankName",C.bankName),l.set("image",C.image),(0,i.TE)(l).then(l=>{E({id:void 0,unitId:void 0,number:void 0,dueDate:new Date()?.toISOString()?.split("T")?.[0],amount:void 0,bankName:void 0,image:void 0}),(0,d.M_)(s?.info.mobile).then(e=>{s?.info.mobile&&p(e.data?.message)}).catch(e=>{}),function(e,t="error",s=3e3){let l=document.getElementById("alert-container"),a=document.createElement("div");a.className="alert alert.success",a.textContent=e,l?.appendChild(a),setTimeout(()=>{l?.removeChild(a)},s)}("تم إضافة الشيك بنجاح","success"),e&&(document.getElementById("body").style.overflow="scroll",t?.(!1))}).catch(e=>{b(e?.response?.data?.error)}).finally(()=>{h(!1)})},M=(0,x.useMemo)(()=>{let e=s?.units?.filter(e=>e.id==C?.unitId);return!!(!e?.[0]?.contractDate&&C?.unitId)},[C]),R=(0,x.useMemo)(()=>{let e=s?.units?.filter(e=>e.id==C?.unitId);return e?.[0]?.completionDate?"لا يمكن إضافة شيك بنكي لهذه الوحدة حيث أنها مستوفاة القيمة الإجمالية":null},[C?.unitId]);return l.jsx(l.Fragment,{children:(0,l.jsxs)("div",{className:"bg-white   w-full p-6 pt-10  flex flex-col gap-5 md:gap-7 rounded-b-lg items-center px-3 md:px-10 ",children:[(0,l.jsxs)("div",{className:"flex flex-col  gap-3 md:gap-[50px] md:flex-row w-full justify-around  ",children:[(0,l.jsxs)("div",{className:"gap-5 md:gap-7 flex flex-col",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-xl font-semibold",children:["الاسم :"," ",(0,l.jsxs)("span",{className:"font-normal text-lg truncate",children:[s?.info.firstName," ",s?.info.lastName]})]}),(0,l.jsxs)("p",{className:"text-black md:hidden text-base md:text-xl font-semibold ",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.info.mobile})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"كود الحجز : "}),l.jsx("div",{className:"w-[230px]",children:l.jsx(o.ZP,{noOptionsMessage:()=>"لا يوجد  ",className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",placeholder:"",value:{label:C?.unitId,value:C?.unitId},onChange:e=>{E({...C,unitId:e?.value})},isDisabled:!1,isLoading:!1,isClearable:!1,isRtl:!0,isSearchable:!1,name:"Codes",options:y})})]}),l.jsx("p",{className:"text-red-600  h-4",children:R||(M?"لا يمكن إضافة شيك بنكي إلا بعد توقيع العقد وتحديث بيانات العميل بذلك":"")})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"اسم البنك : "}),l.jsx("div",{className:"w-[200px] md:w-[330px]",children:l.jsx(o.ZP,{noOptionsMessage:()=>"لا يوجد  ",className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",placeholder:"",isDisabled:!1,isLoading:!1,isClearable:!1,isRtl:!0,isSearchable:!0,options:a.A6,value:a.A6?.filter(e=>e.value==C.bankName),onChange:e=>{E({...C,bankName:e?.value})}})})]}),(0,l.jsxs)("div",{className:"flex flex-row w-full gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"تاريخ الاستحقاق : "}),l.jsx("input",{"aria-label":"Date",placeholder:"يوم/شهر/سنة",value:C.dueDate,onChange:e=>{E({...C,dueDate:e.target.value})},className:"bg-[#F2F0EF]  w-[200px] md:w-[270px]  h-11 rounded-[10px] px-2 text-base",type:"date"})]})]}),(0,l.jsxs)("div",{className:"gap-5 flex flex-col md:gap-7",children:[(0,l.jsxs)("p",{className:"text-black hidden md:flex text-base md:text-xl font-semibold ",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.info.mobile})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:" القيمة : "}),l.jsx("input",{className:"bg-[#F2F0EF] h-11  rounded-[10px] w-[105px] px-2 text-base",type:"tel",value:C.amount,onChange:e=>{/^[0-9]*$/.test(e.target.value)&&E({...C,amount:e.target.value})}}),l.jsx("p",{className:"text-xl ",children:" جنيه "})]}),l.jsx("p",{className:"text-red-600  h-4"})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:" رقم الشيك : "}),l.jsx("input",{value:C?.number,onChange:e=>{/^[0-9]*$/.test(e.target.value)&&E({...C,number:e.target.value})},className:"bg-[#F2F0EF] h-11  rounded-[10px] w-[170px] px-2 text-base",type:"text"})]})]})]}),l.jsx(g,{form:C,setForm:E}),l.jsx("p",{className:"text-red-600 text-base",children:N?"الحد الأقصى لحجم الملف هو 1 ميجابايت":f||""}),l.jsx("div",{className:"flex flex-col gap-y-2 md:flex-row w-full justify-center",children:l.jsx("button",{disabled:!(C?.image&&C.amount&&C.bankName&&C.unitId&&C.unitId&&C.number&&C?.dueDate)||!!N||!s||!!M||!!R,onClick:()=>{document.getElementById("body").style.overflow="scroll",I()},className:`bg-THEME_PRIMARY_COLOR w-full flex items-center justify-center md:w-[160px] text-white rounded-md h-[50px] min-h-[50px]${C?.image&&C.amount&&C.bankName&&C.unitId&&C.unitId&&C.number&&C.dueDate&&!N&&s&&!M&&!R?"":" opacity-50"}`,children:u?l.jsx(m.T,{}):" إضافة"})})]})})}function j({isModal:e,setShowModal:t}){let[s,r]=(0,x.useState)({adviceDate:new Date().toISOString().split("T")[0],adviceTime:"00:00",paymentType:void 0,paymentMethod:void 0,comments:"",amount:"",transactionNumber:"",unitId:void 0,id:void 0}),[c,p]=(0,x.useState)(!1),[u,h]=(0,x.useState)(""),[f,g]=(0,x.useState)(""),{currentUser:b,setCurrentUser:j}=(0,n.b)(),w=(0,x.useMemo)(()=>{let e=[...new Set([...b?.bankChecks.map(e=>e.unitId)??[],...b?.payments.map(e=>e.unitId)??[]])];return[{value:"حجز جديد",label:"حجز جديد"},...e=(e=e.filter(e=>""!=e)?.sort((e,t)=>e?.split("/")[1]-t?.split("/")[1])).map(e=>({value:e,label:e}))]},[b]),N=(0,x.useMemo)(()=>{if(h(""),!s.unitId)return"";if(s?.unitId=="حجز جديد")return r({...s,paymentType:"booking"}),a.KM?.[0]?.label;if(b?.units?.length){let e=b?.units?.filter(e=>e.id==s?.unitId);if(!e?.[0]?.contractingDate)return r({...s,paymentType:"contracting"}),a.KM?.[1]?.label;if(!e?.[0]?.contractDate&&!e?.[0]?.completionDate&&e?.[0]?.category!="نوع الوحدة لم يتحدد")return r({...s,paymentType:"cashing"}),a.KM?.[2]?.label;h(e?.[0]?.category=="نوع الوحدة لم يتحدد"?"يجب اختيار نوع الوحدة لهذا الحجز أولاً قبل إضافة مدفوعات جديدة":e?.[0]?.completionDate?"هذه الوحدة مستوفاة القيمة الإجمالية ، لا يمكن أي دفع مبالغ مالية عليها الآن":"هذه الوحدة تم إنهاء إجراءات التعاقد عليها ، لا يمكن دفع أي مبالغ مالية عليها الآن")}return"غير متاح"},[s?.unitId,b]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:`flex relative   flex-col gap-3 ${e?"md:gap-[80px]":""} md:flex-row w-full  ${e?"justify-between":"justify-between md:w-[80%]"} `,children:[(0,l.jsxs)("div",{className:"gap-5 flex flex-col",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-xl ",children:["الاسم :"," ",l.jsx("span",{className:"font-normal text-lg truncate",children:b?`${b?.info.firstName} ${b?.info.lastName}`:"غير معلوم"}),(0,l.jsxs)("p",{className:"text-black  md:hidden text-base md:text-xl  ",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:b?b?.info.mobile:"غير معلوم"})]})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"كود الحجز : "}),b?l.jsx("div",{className:"w-[230px]",children:l.jsx(o.ZP,{noOptionsMessage:()=>"لا يوجد  ",className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",placeholder:"",value:{label:s?.unitId,value:s?.unitId},onChange:e=>{r({...s,unitId:e?.value})},isDisabled:!1,isLoading:!1,isClearable:!1,isRtl:!0,isSearchable:!1,name:"color",options:w})}):l.jsx("p",{className:"text-lg font-normal",children:"غير معلوم"})]}),u?l.jsx("p",{className:"min-h-6  md:absolute h-auto md:h-6 md:top-[100px] md:start-[85px]  text-red-600 text-center md:text-start",children:u}):"",(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center mt-0 md:mt-4",children:[l.jsx("p",{className:"text-xl font-medium",children:" القيمة : "}),l.jsx("input",{className:"bg-[#F2F0EF] h-11  rounded-[10px] w-[105px] px-2 text-base",type:"text",value:s?.amount,onChange:e=>{/^[0-9]*$/.test(e.target.value)&&r({...s,amount:e.target.value})}}),l.jsx("p",{className:"text-xl ",children:" جنيه "})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"التاريخ : "}),l.jsx("input",{value:s?.adviceDate??new Date().toISOString().split("T")[0],onChange:e=>{r({...s,adviceDate:e.target.value})},className:"bg-[#F2F0EF] w-[230px]  h-11 rounded-[10px] px-2 text-base",type:"date",max:new Date().toISOString()?.split("T")?.[0]})]})]}),(0,l.jsxs)("div",{className:"gap-5 flex flex-col",children:[(0,l.jsxs)("p",{className:"text-black hidden md:flex text-base md:text-xl   h-[28.6px]",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:b?b?.info.mobile:"غير معلوم"})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center h-11",children:[l.jsx("p",{className:"text-xl font-medium",children:"توجيه الدفع : "}),l.jsx("p",{className:"text-lg font-normal",children:b?"غير متاح"==N?l.jsx("p",{className:"text-red-600 text-base",children:N}):N:"غير معلوم"})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center h-11 mt-0  md:mt-4",children:[l.jsx("p",{className:"text-xl font-medium",children:"طريقة الدفع : "}),l.jsx("div",{className:"w-[143px]",children:l.jsx(o.ZP,{className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",isDisabled:!1,isLoading:!1,placeholder:"",isClearable:!1,isRtl:!0,isSearchable:!1,name:"paymentMethod",options:a.X_,value:s?.paymentMethod?a.X_?.filter?.(e=>e.value==s?.paymentMethod):null,onChange:e=>{r({...s,paymentMethod:e?.value})}})})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center h-11",children:[l.jsx("p",{className:"text-xl font-medium",children:"الوقت : "}),l.jsx("input",{"aria-label":"time",className:"bg-[#F2F0EF] w-[130px] h-11 rounded-md px-2 text-base",type:"time",value:s?.adviceTime,onChange:e=>{r({...s,adviceTime:e.target.value})}})]})]})]}),(0,l.jsxs)("div",{className:`${e?"w-full":"flex  flex-col gap-5   justify-between px-0  w-full md:w-[80%]"}`,children:[(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center w-full",children:[l.jsx("p",{className:"text-xl font-medium min-w-[100px]",children:"رقم المعاملة : "}),l.jsx("input",{className:"bg-[#F2F0EF]  h-11  w-full rounded-md px-2 text-base",type:"text",value:s?.transactionNumber,onChange:e=>{r({...s,transactionNumber:e.target.value})}})]}),(0,l.jsxs)("div",{className:`flex flex-row gap-1 items-start w-full ${e?"mt-4":""}`,children:[l.jsx("p",{className:"text-xl font-medium min-w-[100px]",children:"ملاحظات : "}),l.jsx("textarea",{rows:5,className:"bg-[#F2F0EF] p-1 h-[80px] outline-none  w-full rounded-md px-2 text-base",value:s?.comments,onChange:e=>{r({...s,comments:e.target.value})}})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-center  -mt-2 w-full",children:[l.jsx("p",{className:"text-red-600 text-base min-h-6 ",children:f}),(0,l.jsxs)("div",{className:`flex flex-col gap-y-2 md:flex-row w-full justify-around ${e?"":"items-center"}`,children:[l.jsx("button",{onClick:()=>{p(!0);let l={...s};b?.info.id&&(l.id=b?.info?.id),(0,i._w)({...l,adviceDate:new Date(`${s.adviceDate}T${s.adviceTime}`).toISOString(),unitId:s?.unitId=="حجز جديد"?"":s?.unitId}).then(s=>{r({adviceDate:void 0,adviceTime:void 0,paymentType:void 0,paymentMethod:void 0,comments:"",amount:"",transactionNumber:"",unitId:void 0,id:void 0}),b&&(0,d.M_)(b?.info.mobile).then(e=>{b?.info.mobile&&j(e.data?.message)}),function(e,t="error",s=3e3){let l=document.getElementById("alert-container"),a=document.createElement("div");a.className="alert alert.success",a.textContent=e,l?.appendChild(a),setTimeout(()=>{l?.removeChild(a)},s)}("تم إضافة عملية الدفع","success"),window.scroll({top:0}),e&&(document.getElementById("body").style.overflow="scroll",t(!1))}).catch(e=>{g(e.response.data.error)}).finally(()=>{p(!1)})},disabled:b&&(!s?.unitId||!s?.paymentType)||!s?.paymentMethod||!s.adviceTime||!s.adviceDate||!s?.amount||!s.transactionNumber,className:`bg-THEME_PRIMARY_COLOR w-full flex items-center justify-center md:w-[160px] text-white rounded-md h-[50px] min-h-[50px] ${(!b||s?.unitId&&s?.paymentType)&&s?.paymentMethod&&s.adviceTime&&s.adviceDate&&s?.amount&&s.transactionNumber?"":"opacity-50"}`,children:c?l.jsx(m.T,{}):"          إضافة"}),e?l.jsx("button",{onClick:()=>{document.getElementById("body").style.overflow="scroll",t(!1)},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px]",children:"إلغاء"}):""]})]})]})}var w=s(5305);function N({showModal:e,setShowModal:t}){(0,r.getCookie)("authToken"),(0,c.useRouter)();let{currentUser:s,selectedType:a,checks:i}=(0,n.b)();return l.jsx(l.Fragment,{children:e?l.jsx(w.u,{setShowModal:t,isTopCentered:!0,children:(0,l.jsxs)("div",{className:" w-auto  min-w-full md:min-w-[600px] mt-10 ",children:[(0,l.jsxs)("div",{className:"h-[50px] w-full rounded-t-lg bg-THEME_PRIMARY_COLOR flex flex-row justify-between px-6 items-center",children:[l.jsx("p",{className:"text-base md:text-xl  text-white font-semibold",children:a?.subCat==0?"  إضافة مدفوعات":"إضافة شيك بنكي"}),l.jsx("img",{src:"/assets/close.png",className:"w-5 h-5 cursor-pointer",width:20,onClick:()=>{document.getElementById("body").style.overflow="scroll",t(!1)},height:20})]}),0==a.subCat?l.jsx(l.Fragment,{children:l.jsx("div",{className:"bg-white h-[450px] md:h-auto max-h-auto overflow-auto w-full p-6 pt-10  flex flex-col gap-5 rounded-b-lg items-center px-3 md:px-10 ",children:l.jsx(j,{isModal:!0,setShowModal:t})})}):l.jsx(b,{isModal:!0,setShowModal:t})]})}):""})}function v({payment:e}){return(0,c.useRouter)(),l.jsx(l.Fragment,{children:(0,l.jsxs)("div",{className:"border-[1px] border-[#E5EAF4] rounded-2xl py-3 md:py-[34px] px-3 md:px-6 md:pe-[20px]  w-full md:w-[49%]  ",children:[(0,l.jsxs)("div",{className:"flex pb-4 flex-row  gap-6   justify-between items-center border-b-[1px] border-[#D8D8D8] border-solid",children:[(0,l.jsxs)("p",{className:"text-THEME_PRIMARY_COLOR text-sm md:text-lg font-semibold flex flex-col md:flex-row gap-1  w-[46%] md:w-[50%]",children:["القيمة"," ",(0,l.jsxs)("span",{children:[Number(e.amount).toLocaleString()," ","جنيه"]})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-3 items-center tracking-tighter  w-[55%] md:w-[50%] ",children:[l.jsx("img",{src:"/assets/bank.svg",className:"w-[29px]  h-[24px] md:w-[41px] md:h-[41px]"}),l.jsx("div",{className:"flex flex-col gap-1 text-[#048951]   text-sm md:text-[17px]",children:e.bankName})]})]}),(0,l.jsxs)("div",{className:"flex mt-6 flex-row flex-wrap gap-y-8 justify-between",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1 w-[52%] text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"رقم الشيك"}),l.jsx("p",{className:"font-semibold",children:e.number})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 w-[48%]  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"حالة الشيك"}),l.jsx("p",{className:`font-semibold ${e?.status?.current=="outstanding"?"text-[#FF9500]":e?.status?.current=="rejected"?"text-THEME_ERROR_COLOR":"text-[#048951]"}`,children:e.statusText})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 w-[52%]  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"تاريخ الاستحقاق"}),l.jsx("p",{className:"font-semibold flex flex-row gap-1 items-center",children:new Date(e.dueDate)?.toLocaleDateString("en-AE",{day:"numeric",month:"2-digit",year:"numeric"})?.replaceAll("/","-")})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1 w-[48%] text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"كود الحجز"}),l.jsx("p",{className:"cursor-pointer  font-semibold rtl:text-end",dir:"ltr",children:e.unitId})]})]})]})})}function y({payment:e}){(0,c.useRouter)();let[t,s]=(0,x.useState)(!1);return l.jsx(l.Fragment,{children:(0,l.jsxs)("div",{className:"border-[1px] border-[#E5EAF4] rounded-2xl py-3 md:py-[34px] px-3 md:px-6 md:pe-5  w-full md:w-[49%]  ",children:[(0,l.jsxs)("div",{className:"flex pb-4 flex-row  justify-between md:justify-start gap-0  md:gap-[86px] items-center border-b-[1px] border-[#D8D8D8] border-solid",children:[(0,l.jsxs)("p",{className:"text-THEME_PRIMARY_COLOR text-[15px] md:text-xl font-semibold  flex flex-col md:flex-row gap-1",children:["القيمة"," ",(0,l.jsxs)("span",{children:[Number(e.amount).toLocaleString()," ","جنيه"]})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[l.jsx("img",{src:e?.paymentMethod=="instaPay"?"/assets/instaPay3.svg":"bankTransfer"==e.paymentMethod?"/assets/bank_transfer.svg":"bankDeposit"==e.paymentMethod?"/assets/bank_deposit.svg":"/assets/credit.svg",className:`${e?.paymentMethod=="bankTransfer"?"w-[29px]  h-[29px] md:w-[35px] md:h-[35px]":"w-[29px]  h-[24px] md:w-[38px] md:h-[41px]"}`}),l.jsx("div",{className:"flex flex-col gap-1 text-[#048951]  text-sm md:text-lg",children:l.jsx("p",{className:"font-semibold ",children:e.paymentMethodText})})]})]}),(0,l.jsxs)("div",{className:"flex mt-6 flex-row md:gap-[5.5rem] justify-between md:justify-start  rtl:md:gap-28",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"التاريخ"}),l.jsx("p",{className:"font-semibold ",children:new Date(e.adviceDate)?.toLocaleDateString("en-AE",{day:"2-digit",month:"numeric",year:"numeric"})?.replaceAll("/","-")})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"الرقم المرجعي"}),(0,l.jsxs)("p",{className:"font-semibold  flex flex-row gap-1 items-center",dir:"ltr",children:[`${e.id?.substring(0,11)}...`,l.jsx("img",{className:"cursor-pointer",src:`/assets/${t?"copied.png":"copyPrimary.svg"}`,width:"16px",height:"16px",onClick:()=>{s(!0),setTimeout(()=>{s(!1)},2e3),navigator.clipboard.writeText(e.id)}})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"الوقت"}),l.jsx("p",{className:"font-semibold ",children:new Date(e.adviceDate)?.toLocaleTimeString("ar-AE",{hour:"2-digit",minute:"2-digit",hourCycle:"h12"})?.replaceAll("/","-")})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1  text-[#555F71]  text-sm md:text-lg",children:[l.jsx("p",{children:"كود الحجز"}),l.jsx("p",{className:`${(e.unitId,"")} font-semibold  `,dir:"ltr",children:""!=e.unitId?e.unitId:"لا يوجد بعد"})]})]})]})]})})}var C=s(45);let E=(e,t)=>C.Z.post("staff/get-unit-types",{unitId:e,id:t},{headers:{"accept-language":"ar"}}),I=(e,t,s)=>C.Z.post("staff/select-unit-type",{unitId:e,category:t,id:s},{headers:{"accept-language":"ar"}});function M({item:e,setShowUnitModal:t}){let[s,a]=(0,x.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{id:e.id,className:" relative border-[1px] border-[#E5EAF4] rounded-2xl py-3 md:py-[34px] px-4 md:px-6 md:pe-5  w-full md:w-[49%]  ",children:[(0,l.jsxs)("div",{className:"flex flex-row justify-between items-start",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:"text-[#048951]  text-sm md:text-lg font-semibold ",children:e.category}),(0,l.jsxs)("p",{className:"text-[#555F71]  text-sm md:text-lg flex flex-row items-center ltr:gap-6 rtl:gap-2.5 ",children:["رقم الوحدة"," ",l.jsx("span",{className:"text-THEME_PRIMARY_COLOR",children:e.unitNumber})]})]}),e?.contractingDate&&!e?.contractDate&&e?.category=="نوع الوحدة لم يتحدد"?l.jsx("img",{src:"/assets/edit2.svg",className:"cursor-pointer ",width:"32px",height:"32px",onClick:()=>{a(!0)}}):e?.contractingDate&&!e?.contractDate&&e?.category!="نوع الوحدة لم يتحدد"?l.jsx("img",{className:"cursor-pointer",src:"/assets/add_contract.svg",width:30,onClick:()=>{t(!0)}}):e?.contractDate?l.jsx("a",{href:e?.contract?.pdfUrl,target:"_blank",children:l.jsx("img",{src:"/assets/download_contract.svg",className:"cursor-pointer ",width:30})}):""]}),l.jsx("div",{className:"flex flex-row justify-between items-center",children:(0,l.jsxs)("p",{className:"mt-1 text-[#555F71] text-sm md:text-lg flex flex-row items-center rtl:gap-[21px] ltr:gap-2.5 ",children:["كود الحجز"," ",l.jsx("span",{className:"text-THEME_PRIMARY_COLOR",dir:"ltr",children:e.id})]})}),l.jsx("hr",{className:"border-[0.5px]  my-2.5 md:my-5 md:block border-[#E5EAF4] w-full "}),(0,l.jsxs)("div",{className:"flex flex-row gap-[55px] rtl:gap-6 ",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"تاريخ الحجز"}),l.jsx("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:new Date(e.bookingDate)?.toLocaleDateString("en-AE",{day:"2-digit",month:"numeric",year:"numeric"})?.replaceAll("/","-")})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"تاريخ العقد"}),l.jsx("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:e.contractDate?new Date(e.contractDate)?.toLocaleDateString("en-AE",{day:"2-digit",month:"numeric",year:"numeric"})?.replaceAll("/","-"):"لم يتم بعد"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"إجمالي المدفوعات"}),(0,l.jsxs)("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:[Number(e.totalCashAmount).toLocaleString()," ","جنيه"]})]})]}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"تاريخ دفعة التعاقد"}),l.jsx("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:e.contractingDate?new Date(e.contractingDate)?.toLocaleDateString("en-AE",{day:"2-digit",month:"numeric",year:"numeric"})?.replaceAll("/","-"):"لم يتم بعد"})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"سعر الوحدة"}),l.jsx("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:`${e.totalAmount?`${e.totalAmount.toLocaleString()} جنيه`:"بعد اختيار الوحدة"}`})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[l.jsx("p",{className:" text-xs md:text-base  text-[#555F71]",children:"إجمالي قيمة الشيكات"}),l.jsx("p",{className:" text-xs md:text-base font-semibold  text-[#555F71]",children:`${e.totalChecksAmount?`${e.totalChecksAmount.toLocaleString()} جنيه`:"لا يوجد شيكات"}`})]})]})]})]}),s?l.jsx(w.u,{isTopCentered:!0,setShowModal:a,children:l.jsx(S,{closeModal:()=>{a(!1),document.getElementById("body").style.overflow="scroll"},unitId:e?.id})}):""]})}let R=({unit:e,isSelected:t,onSelect:s,isActive:a})=>(0,l.jsxs)("div",{onClick:()=>{a&&s()},className:`relative cursor-pointer border-[1px] border-solid ${a?"":"opacity-65"} border-[#E5EAF4] w-full md:flex-1 rtl:px-6 ltr:px-6 pt-6 pb-6 rounded-2xl flex flex-col gap-6 ${t?"bg-THEME_PRIMARY_COLOR":"bg-white"}`,children:[l.jsx("div",{onClick:()=>{a&&s()},className:`w-7 h-7 absolute end-6 top-6 rounded-[20px] flex flex-row justify-center items-center border-[2px] ${t?" border-white":" border-[#D1DAE6]"}  `,children:t?l.jsx("p",{className:"w-5 h-5  rounded-[20px] bg-white"}):""}),l.jsx("img",{src:`/assets/cat${e.category.replace("category","")}${t?"_inverted":""}.svg`,className:"!w-[181px] !h-[36px] mt-5"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[l.jsx("p",{className:`text-xl font-semibold rtl:font-medium tracking-tight ${t?"text-white":"text-THEME_PRIMARY_COLOR"} rtl:h-8 ltr:h-16`,children:e.categoryName}),(0,l.jsxs)("p",{className:`text-lg ${t?"text-white":"text-THEME_SECONDARY_COLOR"}`,children:["دفعة الحجز"," :"," ",(0,l.jsxs)("span",{className:"font-semibold rtl:font-medium",children:[Number(e.bookingAmount).toLocaleString()," ","جنيه"]})]}),(0,l.jsxs)("p",{className:`text-lg ${t?"text-white":"text-THEME_SECONDARY_COLOR"}`,children:["دفعة التعاقد",(0,l.jsxs)("span",{className:"font-semibold rtl:font-medium",children:[Number(e.contractingAmount).toLocaleString()," ","جنيه"]})]}),(0,l.jsxs)("p",{className:`text-lg ${t?"text-white":"text-THEME_SECONDARY_COLOR"}`,children:["أقساط"," :"," ",l.jsx("span",{className:"font-semibold rtl:font-medium tracking-tight",children:`${e.installments.count} أقساط - قسط كل ${e.installments.spanInMonths} أشهر`})]}),(0,l.jsxs)("p",{className:`text-lg ${t?"text-white":"text-THEME_SECONDARY_COLOR"}`,children:["قيمة القسط"," :"," ",(0,l.jsxs)("span",{className:"font-semibold rtl:font-medium",children:[Number(e.installments.amount).toLocaleString()," ","جنيه"]})]}),(0,l.jsxs)("p",{className:`text-lg ${t?"text-white":"text-THEME_SECONDARY_COLOR"}`,children:[" سعر الكاش",(0,l.jsxs)("span",{className:"font-semibold rtl:font-medium",children:[Number(e.cashAmount).toLocaleString()," ","جنيه"]})]})]})]}),S=({closeModal:e,unitId:t})=>{let[s,a]=(0,x.useState)(!1),[i,r]=(0,x.useState)(!1),[c,o]=(0,x.useState)(null),[p,u]=(0,x.useState)(!1),{currentUser:h}=(0,n.b)(),[f,g]=(0,x.useState)([]),[b,j]=(0,x.useState)(""),{setCurrentUser:w}=(0,n.b)();return(0,x.useEffect)(()=>{a(!0),E(t,h?.info?.id).then(e=>{a(!1),g(e.data.message.units),o(e.data.message?.currentCategory?.replace("category","")-1)})},[]),(0,l.jsxs)("div",{className:" min-w-full  mt-10",children:[(0,l.jsxs)("div",{className:"h-[56px] rounded-t-[4px] bg-THEME_PRIMARY_COLOR px-6 py-4 flex flex-row justify-between items-center",children:[l.jsx("p",{className:"font-semibold rtl:font-medium text-white text-base md:text-xl ",children:"نوع الوحدة"}),l.jsx("img",{src:"/assets/close.png",onClick:()=>{e()},className:"w-4 h-4 cursor-pointer"})]}),(0,l.jsxs)("div",{className:"w-full bg-white rounded-b-[4px] px-6  md:px-12  ",children:[p?null:l.jsx("p",{className:"text-center text-THEME_PRIMARY_COLOR text-xl md:text-3xl font-semibold rtl:font-medium  pt-5 pb-2  md:py-7",children:"اختر نوع الوحدة"}),l.jsx("div",{className:" min-h-[350px] h-[370px] overflow-scroll md:overflow-hidden md:h-auto  flex flex-col md:flex-row gap-7",children:p?(0,l.jsxs)("div",{className:"flex min-h-[350px] w-full flex-col justify-center items-center",children:[l.jsx("img",{src:"/assets/success.png",width:"200px",height:"200px"}),l.jsx("p",{className:"my-6 md:my-3 text-[hsl(224,5%,48%)] text-lg w-full  md:w-1/2 text-center",children:"تم اختيار فئة وحدتك بنجاح"})]}):l.jsx(l.Fragment,{children:s?l.jsx("div",{className:"h-[350px] w-full flex justify-center items-center",children:l.jsx(m.T,{})}):(0,l.jsxs)(l.Fragment,{children:[" ",f.sort((e,t)=>e.category.replace("category","")-t.category.replace("category",""))?.map((e,t)=>l.jsx(R,{onSelect:()=>{o(t)},isSelected:c==t,unit:e,isActive:e?.isActive},`card_${t}`))]})})}),l.jsx("div",{className:"w-full gap-3   flex flex-col gap items-center",children:p?l.jsx("button",{onClick:()=>{a(!0),(0,d.M_)(h?.info.mobile).then(t=>{h?.info.mobile&&(w(t.data?.message),e(),a(!1),function(e,t="error",s=3e3){let l=document.getElementById("alert-container"),a=document.createElement("div");a.className="alert alert.success",a.textContent=e,l?.appendChild(a),setTimeout(()=>{l?.removeChild(a)},s)}("تم اختيار الوحدة بنجاح","success"))}).catch(e=>{})},className:"w-full md:w-[181px] mb-6 mt-3 flex justify-center items-center rounded-lg h-12 disabled:opacity-40 bg-THEME_PRIMARY_COLOR text-white text-center",children:s?l.jsx(m.T,{}):"اغلاق"}):(0,l.jsxs)(l.Fragment,{children:[""!=b?l.jsx("p",{className:"mt-5 md:my-5 text-THEME_ERROR_COLOR text-lg w-full  md:w-1/2 text-center",children:b}):l.jsx("p",{className:"mt-1 md:my-3 text-[#74777F] text-sm md:text-lg w-full  md:w-1/2 text-center",children:"يمكنك تغيير نوع الوحدة طالما لم يتم إنهاء إجراءات التعاقد."}),l.jsx("div",{className:"mb-6 w-full flex justify-end",children:l.jsx("button",{onClick:()=>{r(!0),I(t,f?.[c]?.category,h?.info?.id).then(e=>{r(!1),u(!0)}).catch(e=>{r(!1),j(e.response.data.error)})},disabled:null==c||i,className:"w-full md:w-[181px]  flex justify-center items-center rounded-lg h-12 disabled:opacity-40 bg-THEME_PRIMARY_COLOR text-white text-center",children:i?l.jsx(m.T,{}):"حفظ"})})]})})]})]})};function _({setShowUnitModal:e,selectedUnit:t}){let{currentUser:s,setCurrentUser:a}=(0,n.b)(),[r,c]=(0,x.useState)({id:void 0,unitId:void 0,unitNumber:void 0,contractData:new Date()?.toISOString()?.split("T")?.[0],pdfFile:void 0}),[o,p]=(0,x.useState)(!1),[u,h]=(0,x.useState)(""),[f,g]=(0,x.useState)(!1),b=()=>{h(""),p(!0);let t=new FormData;t.set("id",s?.info.id),t.set("unitId","حجز جديد"==r.unitId?"":r.unitId),t.set("unitNumber",r.unitNumber),t.set("contractDate",r.contractData),t.set("pdfFile",r.pdfFile),(0,i.Jy)(t).then(t=>{c({id:void 0,unitId:void 0,contractData:new Date()?.toISOString()?.split("T")?.[0],unitNumber:void 0,pdfFile:void 0}),(0,d.M_)(s?.info.mobile).then(e=>{s?.info.mobile&&a(e.data?.message)}).catch(e=>{}),function(e,t="error",s=3e3){let l=document.getElementById("alert-container"),a=document.createElement("div");a.className="alert alert.success",a.textContent=e,l?.appendChild(a),setTimeout(()=>{l?.removeChild(a)},s)}("تم إضافة العقد بنجاح","success"),document.getElementById("body").style.overflow="scroll",e?.(!1)}).catch(e=>{h(e?.response?.data?.error)}).finally(()=>{p(!1)})};return l.jsx(w.u,{setShowModal:e,isTopCentered:!1,children:(0,l.jsxs)("div",{className:" w-auto  min-w-full md:min-w-[600px] mt-10 ",children:[(0,l.jsxs)("div",{className:"h-[50px] w-full rounded-t-lg bg-THEME_PRIMARY_COLOR flex flex-row justify-between px-6 items-center",children:[l.jsx("p",{className:"text-base md:text-xl  text-white font-semibold",children:"تسجيل العقد"}),l.jsx("img",{src:"/assets/close.png",className:"w-5 h-5 cursor-pointer",width:20,onClick:()=>{document.getElementById("body").style.overflow="scroll",e(!1)},height:20})]}),(0,l.jsxs)("div",{className:"bg-white h-[450px] md:h-auto max-h-auto overflow-auto w-auto p-6 pt-10  flex flex-col gap-5 rounded-b-lg items-center px-3 md:px-10 ",children:[(0,l.jsxs)("div",{className:"flex flex-col  gap-3 md:gap-[40px] md:flex-row w-full   ",children:[(0,l.jsxs)("div",{className:"gap-5 flex flex-col",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-xl font-semibold",children:["الاسم :"," ",(0,l.jsxs)("span",{className:"font-normal text-lg truncate",children:[s?.info.firstName," ",s?.info.lastName]})]}),(0,l.jsxs)("p",{className:"text-black md:hidden text-base md:text-xl font-semibold ",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.info.mobile})]}),(0,l.jsxs)("div",{className:"flex flex-row w-full gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"تاريخ العقد : "}),l.jsx("input",{"aria-label":"Date",placeholder:"يوم/شهر/سنة",value:r.contractData,onChange:e=>{c({...r,contractData:e.target.value})},className:"bg-[#F2F0EF]  w-[200px] md:w-[270px]  h-11 rounded-[10px] px-2 text-base",type:"date",max:new Date().toISOString()?.split("T")?.[0]})]})]}),(0,l.jsxs)("div",{className:"gap-5 flex flex-col",children:[(0,l.jsxs)("p",{className:"text-black hidden md:flex text-base md:text-xl font-semibold ",children:["الهاتف المحمول :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.info.mobile})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:" رقم الوحدة : "}),l.jsx("input",{className:"bg-[#F2F0EF] h-11  rounded-[10px] w-[170px] px-2 text-base",type:"text",value:r.unitNumber,onChange:e=>{/^[0-9]*$/.test(e.target.value)&&c({...r,unitNumber:e.target.value})}})]})]})]}),(0,l.jsxs)("label",{className:"file-upload",children:[l.jsx("input",{type:"file",accept:"application/pdf",onChange:e=>{let t=e.target.files?.[0];t?.size>1048576?g(!0):(c({...r,pdfFile:e.target.files?.[0]}),g(!1))}}),l.jsx("span",{children:r?.pdfFile?r.pdfFile?.name:"تحميل ملف ال PDF الخاص بالعقد "}),l.jsx("img",{src:"/assets/upload_pdf.svg",width:30,alt:"Upload Icon"})]}),l.jsx("p",{className:"text-red-600 text-base",children:f?"الحد الأقصى لحجم الملف هو 1 ميجابايت":u||""}),(0,l.jsxs)("div",{className:"flex flex-col gap-y-2 md:flex-row w-full justify-around",children:[l.jsx("button",{onClick:()=>{b()},disabled:!r?.pdfFile||!r.contractData||!r.unitId||!r.unitNumber||f||!s,className:`bg-THEME_PRIMARY_COLOR flex items-center justify-center w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px] ${r?.pdfFile&&r.contractData&&r.unitId&&r.unitNumber&&!f&&s?"":" opacity-50"}`,children:o?l.jsx(m.T,{}):" إضافة"}),l.jsx("button",{onClick:()=>{document.getElementById("body").style.overflow="scroll",e(!1)},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px]",children:"إلغاء"})]})]})]})})}function T(){let[e,t]=(0,x.useState)(!1),{currentUser:s,selectedType:a}=(0,n.b)(),[i,d]=(0,x.useState)(!1),[r,c]=(0,x.useState)("");return l.jsx(l.Fragment,{children:s&&0==a.cat?(0,l.jsxs)("div",{className:" flex flex-col gap-6 items-center",children:[(0,l.jsxs)("div",{className:"flex justify-between flex-wrap  gap-3 w-full",children:[0==a.subCat?s?.payments?.length?s?.payments.map((e,t)=>l.jsx(y,{payment:e},`payment_${t}`)):(0,l.jsxs)("p",{className:"text-THEME_SECONDARY_COLOR text-2xl text-semibold w-full text-center mt-4",children:[" ","لا يوجد مدفوعات"]}):1==a.subCat?s?.bankChecks?.length?s?.bankChecks.map((e,t)=>l.jsx(v,{payment:e},`check_${t}`)):(0,l.jsxs)("p",{className:"text-THEME_SECONDARY_COLOR text-2xl text-semibold w-full text-center mt-4",children:[" ","لا يوجد شيكات"]}):2==a.subCat?s?.units?.length?(0,l.jsxs)(l.Fragment,{children:[s?.units.map((e,s)=>l.jsx(M,{item:e,setShowUnitModal:()=>{t(!0),c(e.id)}},`unit_${s}`)),e?l.jsx(_,{selectedUnit:r,setShowUnitModal:t}):""]}):(0,l.jsxs)("p",{className:"text-THEME_SECONDARY_COLOR text-2xl text-semibold w-full text-center mt-4",children:[" ","لا يوجد وحدات"," "]}):"",l.jsx(N,{showModal:i,setShowModal:d})]}),2==a.subCat?"":l.jsx("button",{onClick:()=>d(!0),className:"bg-THEME_PRIMARY_COLOR mb-[120px] md:mb-0 w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px]",children:0==a.subCat?"إضافة مدفوعات":"إضافة شيكات"})]}):""})}let O=[{value:"outstanding",label:"في الانتظار"},{value:"cleared",label:"تم الصرف"},{value:"rejected",label:"تم الرفض"},{value:"cashed",label:"تم الاستبدال بالنقد"}];function D({setShowModal:e}){let{setChecks:t,checks:s}=(0,n.b)(),[d,r]=(0,x.useState)(!1),[c,p]=(0,x.useState)(""),[u,h]=(0,x.useState)({newStatus:void 0,adviceDate:void 0});return l.jsx(w.u,{setShowModal:e,isTopCentered:!(window?.innerWidth>768),children:(0,l.jsxs)("div",{className:" w-auto  min-w-full   md:min-w-[450px] md:w-auto mt-[60px] ",children:[(0,l.jsxs)("div",{className:"h-[50px] w-full rounded-t-lg bg-THEME_PRIMARY_COLOR flex flex-row justify-between px-6 items-center",children:[l.jsx("p",{className:"text-base md:text-lg  text-white font-semibold",children:" تحديث حالة الشيك"}),l.jsx("img",{src:"/assets/close.png",className:"w-5 h-5 cursor-pointer",width:20,onClick:()=>{document.getElementById("body").style.overflow="scroll",e(!1)},height:20})]}),(0,l.jsxs)("div",{className:"bg-white h-[450px] md:h-auto max-h-auto overflow-auto w-auto p-6 pt-10  flex flex-col gap-5 rounded-b-lg items-center px-3 md:px-10 ",children:[(0,l.jsxs)("div",{className:"flex flex-col  gap-3 md:gap-[40px]  ",children:[(0,l.jsxs)("div",{className:"gap-5 flex justify-between flex-col md:flex-row",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-lg font-semibold",children:["اسم البنك :"," ",l.jsx("span",{className:"font-normal text-lg truncate",children:s?.[0]?.bankName})]}),(0,l.jsxs)("p",{className:"text-black  text-base md:text-lg font-semibold ",children:["رقم الشيك :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.[0]?.number})]})]}),(0,l.jsxs)("div",{className:"gap-5 md:gap-[70px] items-start md:items-center flex justify-between flex-col md:flex-row",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-lg font-semibold ",children:["حالة الشيك :"," ",l.jsx("span",{dir:"ltr",className:"font-normal text-lg",children:s?.[0]?.statusText})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-lg font-medium",children:"الحالة الجديدة : "}),l.jsx("div",{className:"w-[200px]",children:l.jsx(o.ZP,{noOptionsMessage:()=>"لا يوجد  ",className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",placeholder:"",styles:{menu:e=>({...e,zIndex:1e3})},value:u?.newStatus?O?.filter?.(e=>e.value==u?.newStatus):null,onChange:e=>{h({...u,newStatus:e?.value})},isDisabled:!1,isLoading:!1,isClearable:!1,isRtl:!0,isSearchable:!1,name:"New Status",options:O})})]})]})]}),(0,l.jsxs)("div",{className:"flex  flex-col md:flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-lg font-medium",children:" تاريخ تغيير الحالة : "}),l.jsx("input",{value:u?.adviceDate??new Date().toISOString().split("T")[0],onChange:e=>{h({...u,adviceDate:e.target.value})},className:"bg-[#F2F0EF] w-[230px]  h-11 rounded-[10px] px-2 text-base",type:"date",max:new Date().toISOString()?.split("T")?.[0]})]}),c?l.jsx("p",{className:"text-base text-red-600",children:c}):"",(0,l.jsxs)("div",{className:"flex flex-col mt-4 mb-6 gap-y-2 md:flex-row w-full justify-around ",children:[l.jsx("button",{onClick:()=>{r(!0),(0,i.IZ)({adviceDate:u.adviceDate??new Date().toISOString().split("T")[0],bankName:a.A6?.filter(e=>e.label==s?.[0]?.bankName)?.[0]?.value,newStatus:u?.newStatus,number:s?.[0]?.number}).then(l=>{(0,i._7)(a.A6?.filter(e=>e.label==s?.[0]?.bankName)?.[0]?.value,s?.[0]?.number).then(s=>{t(s.data.message.check),h({adviceDate:void 0,newStatus:void 0}),document.getElementById("body").style.overflow="scroll",e(!1)})}).catch(e=>{p(e?.response?.data?.error)}).finally(()=>{r(!1)})},disabled:!u?.newStatus||s?.[0]?.statusText==O?.filter?.(e=>e.value==u?.newStatus)?.[0]?.label,className:`bg-THEME_PRIMARY_COLOR  flex items-center justify-center w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px] ${u?.newStatus&&s?.[0]?.statusText!=O?.filter?.(e=>e.value==u?.newStatus)?.[0]?.label?"":"opacity-50"}`,children:d?l.jsx(m.T,{}):" تأكيد"}),l.jsx("button",{onClick:()=>{document.getElementById("body").style.overflow="scroll",e(!1)},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[160px] text-white rounded-md h-[50px] min-h-[50px]",children:"إلغاء"})]})]})]})})}function k(){let[e,t]=(0,x.useState)(!1),{setCurrentUser:s,checks:a}=(0,n.b)(),[i,r]=(0,x.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[a.map((e,t)=>l.jsx(v,{payment:e},`check_${t}`)),a?.length>0?(0,l.jsxs)("div",{className:"flex flex-col gap-[100px]  md:flex-row ",children:[l.jsx("button",{onClick:()=>{r(!0)},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[135px] text-white rounded-md h-[50px] min-h-[50px]",children:"تحديث حالة الشيك"}),l.jsx("button",{onClick:()=>{t(!0),(0,d.M_)(a?.[0]?.mobile?.number).then(e=>{s(e.data?.message,!0)}).catch(e=>{s(void 0,!0)}).finally(()=>{t(!1)})},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[135px] text-white rounded-md h-[50px] min-h-[50px]",children:"صفحة العميل"})]}):""]}),i?l.jsx(D,{setShowModal:r}):""]})}function F(){let[e,t]=(0,x.useState)(!1),{setSelectedType:s,checks:i,findPayment:d}=(0,n.b)(),[r,c]=(0,x.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 items-center",children:[d?l.jsx(y,{payment:{...d,adviceDate:d?.date,paymentMethod:a.X_?.filter(e=>e?.label==d.paymentMethod)?.[0]?.value,paymentMethodText:d?.paymentMethod,id:d?.id}},"FindPayment"):"",d?(0,l.jsxs)("div",{className:"flex flex-col gap-[100px]  md:flex-row ",children:[(0,l.jsxs)("button",{onClick:()=>{c(!0)},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[135px] text-white rounded-md h-[50px] min-h-[50px]",children:["عرض المزيد"," "]}),l.jsx("button",{onClick:()=>{t(!0),s({cat:0,subCat:0})},className:"bg-THEME_PRIMARY_COLOR w-full md:w-[135px] text-white rounded-md h-[50px] min-h-[50px]",children:"صفحة العميل"})]}):""]}),r?l.jsx(w.u,{setShowModal:c,isTopCentered:!1,children:(0,l.jsxs)("div",{className:" w-auto  min-w-full   md:min-w-[450px] md:w-auto mt-[60px] ",children:[(0,l.jsxs)("div",{className:"h-[50px] w-full rounded-t-lg bg-THEME_PRIMARY_COLOR flex flex-row justify-between px-6 items-center",children:[l.jsx("p",{className:"text-base md:text-lg  text-white font-semibold",children:" بيانات المعاملة"}),l.jsx("img",{src:"/assets/close.png",className:"w-5 h-5 cursor-pointer",width:20,onClick:()=>{document.getElementById("body").style.overflow="scroll",c(!1)},height:20})]}),l.jsx("div",{className:"bg-white h-[450px] md:h-auto max-h-auto overflow-auto w-auto p-6 pt-10  flex flex-col gap-5 rounded-b-lg items-center px-3 md:px-10 ",children:(0,l.jsxs)("div",{className:"gap-5 flex justify-between flex-col",children:[(0,l.jsxs)("p",{className:"text-black text-base md:text-lg font-semibold",children:["رقم المعاملة :"," ",l.jsx("span",{className:"font-normal text-lg truncate",children:d?.transactionNumber})]}),(0,l.jsxs)("p",{className:"text-black text-base md:text-lg font-semibold",children:["الحالة :"," ",l.jsx("span",{className:"font-normal text-lg truncate",children:d?.status})]}),(0,l.jsxs)("p",{className:"text-black text-base md:text-lg font-semibold",children:["ملاحظات :"," ",l.jsx("span",{className:"font-normal text-lg truncate",children:d?.comments})]}),l.jsx("div",{className:"w-full flex items-center justify-center",children:l.jsx("button",{onClick:()=>{document.getElementById("body").style.overflow="scroll",c(!1)},className:"w-full md:w-[181px] mb-6 mt-3 flex justify-center items-center rounded-lg h-12 disabled:opacity-40 bg-THEME_PRIMARY_COLOR text-white text-center",children:"اغلاق"})})]})})]})}):""]})}function A(){let e=(0,r.getCookie)("authToken");(0,c.useRouter)();let{currentUser:t,selectedType:s,linkPaymentDetails:d,setPaymentLink:p,setCurrentUser:u}=(0,n.b)(),[h,f]=(0,x.useState)({paymentType:void 0,unitId:void 0}),[g,w]=(0,x.useState)(!1),[N,v]=(0,x.useState)(""),[y,C]=(0,x.useState)(""),E=(0,x.useMemo)(()=>{if(v(""),!h.unitId)return"";if(h?.unitId=="حجز جديد")return f({...h,paymentType:"booking"}),a.KM?.[0]?.label;if(t?.units?.length){let e=t?.units?.filter(e=>e.id==h?.unitId);if(!e?.[0]?.contractingDate)return f({...h,paymentType:"contracting"}),a.KM?.[1]?.label;if(!e?.[0]?.contractDate&&!e?.[0]?.completionDate&&e?.[0]?.category!="نوع الوحدة لم يتحدد")return f({...h,paymentType:"cashing"}),a.KM?.[2]?.label;v(e?.[0]?.category=="نوع الوحدة لم يتحدد"?"يجب اختيار نوع الوحدة لهذا الحجز أولاً قبل إضافة مدفوعات جديدة":e?.[0]?.completionDate?"هذه الوحدة مستوفاة القيمة الإجمالية ، لا يمكن أي دفع مبالغ مالية عليها الآن":"هذه الوحدة تم إنهاء إجراءات التعاقد عليها ، لا يمكن دفع أي مبالغ مالية عليها الآن")}return"غير متاح"},[h?.unitId]),I=(0,x.useMemo)(()=>{let e=[...new Set([...t?.bankChecks.map(e=>e.unitId)??[],...t?.payments.map(e=>e.unitId)??[]])];return[{value:"حجز جديد",label:"حجز جديد"},...e=(e=e.filter(e=>""!=e)?.sort((e,t)=>e?.split("/")[1]-t?.split("/")[1])).map(e=>({value:e,label:e}))]},[t]);return l.jsx(l.Fragment,{children:e?l.jsx(l.Fragment,{children:l.jsx("div",{className:" mt-4 mb-3 ",children:t&&0==s.cat?l.jsx(T,{}):1==s.cat?l.jsx(l.Fragment,{children:0==s.subCat?l.jsx("div",{className:"bg-white mb-[80px] md:mb-0 md:h-auto max-h-auto  w-full p-6 pt-10  flex flex-col gap-5 rounded-b-lg items-center px-3 md:px-10 ",children:l.jsx(j,{isModal:!1,setShowModal:()=>{}})}):s?.subCat==1?l.jsx(F,{}):s?.subCat==2?(0,l.jsxs)("div",{className:"flex  items-center flex-col gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-row justify-around items-center w-full mt-8",children:[l.jsx("div",{children:(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center",children:[l.jsx("p",{className:"text-xl font-medium",children:"كود الحجز : "}),t?l.jsx("div",{className:"w-[230px]",children:l.jsx(o.ZP,{noOptionsMessage:()=>"لا يوجد  ",className:"basic-single  h-11 rounded-md  text-base border-none",classNamePrefix:"select",placeholder:"",value:{label:h?.unitId,value:h?.unitId},onChange:e=>{f({...h,unitId:e?.value})},isDisabled:!1,isLoading:!1,isClearable:!1,isRtl:!0,isSearchable:!1,name:"color",options:I})}):l.jsx("p",{className:"text-lg font-normal",children:"غير معلوم"})]})}),(0,l.jsxs)("div",{className:"flex flex-row gap-1 items-center h-11",children:[l.jsx("p",{className:"text-xl font-medium",children:"توجيه الدفع : "}),l.jsx("p",{className:"text-lg font-normal",children:t?"غير متاح"==E?l.jsx("p",{className:"text-red-600 text-base",children:E}):E:"غير معلوم"})]})]}),l.jsx("p",{className:"text-base  text-red-600 mt-1 px-5 h-auto   md:h-6 ps-5 md:ps-[170px] text-center md:text-start",children:N||y||""}),l.jsx("button",{disabled:!t?.info?.id||"غير متاح"==E||!h.unitId||""==d.transactionNumber||""==d.paymentType,onClick:()=>{w(!0),(0,i.ge)(t?.info.id,h?.unitId=="حجز جديد"?"":h?.unitId,h?.paymentType,d?.paymentType,d.transactionNumber).then(e=>{(function(e,t="error",s=3e3){let l=document.getElementById("alert-container"),a=document.createElement("div");a.className="alert alert.success",a.textContent=e,l?.appendChild(a),setTimeout(()=>{l?.removeChild(a)},s)})("تم ربط عملية الدفع بنجاح","success"),f({paymentType:"",unitId:""}),p({amount:"",date:"",id:"",paymentType:"",transactionNumber:"",isFlush:!0})}).catch(e=>{C(e?.response?.data?.error)}).finally(()=>{w(!1)})},className:`bg-THEME_PRIMARY_COLOR w-full flex items-center justify-center md:w-[160px] text-white rounded-md h-[50px] min-h-[50px] ${t?.info?.id&&"غير متاح"!=E&&h.unitId&&""!=d.transactionNumber&&""!=d.paymentType?"":"opacity-50"}`,children:g?l.jsx(m.T,{}):"إضافة"})]}):3==s.subCat?l.jsx(b,{}):4==s.subCat?l.jsx(k,{}):""}):""})}):""})}},4148:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});let l=(0,s(5347).createProxy)(String.raw`/Users/ahmed.galal/back-office/back-office-next/src/app/page.tsx#default`)},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var l=s(4564);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,l.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[379,242,564,747,315],()=>s(6990));module.exports=l})();